<!DOCTYPE html>
<html lang="en">
	<head>
		<meta charset="utf-8" />
		<meta name="viewport" content="width=device-width, initial-scale=1.0" />
		<title>Demo</title>
	</head>
	<body>
		<div id="lobby-container">
			<button id="create-lobby">Create public lobby</button>
			<div id="multiplayer-mode">
				<input type="text" id="lobby-code-input" placeholder="Enter lobby code" />
				<button id="join-lobby">Connect to Lobby</button>
			</div>
			<button id="singleplayer-mode">Create private lobby</button>
		</div>

		<div id="ids"></div>

		<script>
			let createLobbyButton = document.getElementById("create-lobby");
			let joinLobbyButton = document.getElementById("join-lobby");
			let lobbyCodeInput = document.getElementById("lobby-code-input");
			let singleplayerButton = document.getElementById("singleplayer-mode");

			let idsDiv = document.getElementById("ids");

			createLobbyButton.addEventListener("click", async () => {
				let response = await fetch("/create", {
					method: "POST",
					headers: { "Content-Type": "application/json" },
					body: JSON.stringify({ isPrivate: false }),
				});

				let { roomId } = await response.json();
				window.location = `/room/${roomId}`;
			});

			joinLobbyButton.addEventListener("click", () => {
				const lobbyCode = lobbyCodeInput.value.trim();

				fetch(`/checkRoomId/${lobbyCode}`)
					.then((response) => {
						if (response.ok) {
							window.location = `/room/${lobbyCode}`;
						} else {
							throw new Error("Please enter a valid lobby code.");
						}
					})
					.catch((error) => {
						alert(error.message);
					});
			});

			singleplayerButton.addEventListener("click", async () => {
				let response = await fetch("/create", {
					method: "POST",
					headers: { "Content-Type": "application/json" },
					body: JSON.stringify({ isPrivate: true }),
				});

				let { roomId } = await response.json();
				window.location = `/room/${roomId}`;
			});
		</script>
	</body>
</html>
